<?xml version= "1.0" ?>
<odoo>

    <record model="ir.ui.view" id="code_generator_module_form">
        <field name="name">code.generator.module.form</field>
        <field name="model">code.generator.module</field>
        <field name="mode">primary</field>
        <field name="inherit_id" ref="base.module_form"/>
        <field name="arch" type="xml">
            <form position="attributes">
                <attribute name="create">1</attribute>
                <attribute name="edit">1</attribute>
            </form>

            <xpath expr="//div[hasclass('oe_title')]" position="replace">
                <div class="oe_title mb32">
                    <h1>
                        <field name="shortdesc" placeholder="Brief Description" class="shortdesc_input"/>
                    </h1>
                    <h3 class="oe_fade">
                        By
                        <field name="author" class="oe_inline" placeholder="Author Name"/>
                    </h3>
                </div>
            </xpath>

            <notebook position="replace">

                <notebook groups="base.group_no_one">
                    <page string="Information">
                        <group>
                            <group>
                                <field name="category_id" />
                                <field name="summary" />
                            </group>
                            <group>
                                <field name="name" class="name_input" />
                                <field name="license"/>
                                <field name="installed_version"/>
                            </group>
                        </group>
                    </page>
                    <page string="Technical Data">
                        <group>
                            <group>
                                <field name="application" class="application_input" />
                            </group>
                        </group>
                        <group string="Dependencies"/>
                        <field name="dependencies_id">
                            <tree string="Dependencies">
                                <field name="name"/>
                                <field name="state"/>
                            </tree>
                        </field>
                    </page>
                </notebook>

            </notebook>

        </field>
    </record>

    <record model="ir.ui.view" id="code_generator_module_tree">
        <field name="name">code.generator.module.tree</field>
        <field name="model">code.generator.module</field>
        <field name="mode">primary</field>
        <field name="inherit_id" ref="base.module_tree"/>
        <field name="arch" type="xml">
            <tree position="attributes">
                <attribute name="create">1</attribute>
                <attribute name="decoration-info">''</attribute>
                <attribute name="decoration-danger">''</attribute>
                <attribute name="decoration-muted">''</attribute>
            </tree>
            <field name="website" position="replace"/>
            <field name="installed_version" position="replace"/>
            <field name="state" position="replace"/>
        </field>
    </record>

    <record model="ir.ui.view" id="code_generator_module_search">
        <field name="name">code.generator.module.search</field>
        <field name="model">code.generator.module</field>
        <field name="mode">primary</field>
        <field name="inherit_id" ref="base.view_module_filter"/>
        <field name="arch" type="xml">
            <search position="attributes">
                <attribute name="string">Code Generator Module Search</attribute>
            </search>
            <separator position="replace"/>
            <filter name="installed" position="replace"/>
            <filter name="not_installed" position="replace"/>
        </field>
    </record>

    <record model="ir.actions.act_window" id="code_generator_module_actionwindow">
        <field name="name">Modules</field>
        <field name="res_model">code.generator.module</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('state', '!=', 'uninstallable')]</field>
        <field name="context">{'search_default_app':1}</field>
        <field name="search_view_id" ref="code_generator_module_search"/>
        <field name="help" type="html">
            <p class="o_view_nocontent_empty_folder">
                Add a new module
            </p>
            <p>
                Module whose content will be export into code
            </p>
        </field>
    </record>

    <record model="ir.actions.client" id="code_generator_dashboard">
        <field name="name">Tablero</field>
        <field name="tag">code_generator_dashboard.main</field>
    </record>

    <menuitem id="code_generator_main_menu" name="Code Generator" />

    <menuitem id="code_generator_dashboard_menu"
              name="Tablero"
              parent="code_generator_main_menu"
              action="code_generator_dashboard"
              groups="base.group_system"
              sequence="1"
    />

    <menuitem id="code_generator_generator_menu"
              name="Modules"
              parent="code_generator_main_menu"
              action="code_generator_module_actionwindow"
              groups="code_generator_manager"
              sequence="3"
    />

    <record model="ir.actions.server" id="code_generator_module_actionserver">
        <field name="name">Generate code</field>
        <field name="model_id" ref="model_code_generator_module"/>
        <field name="binding_model_id" ref="model_code_generator_module"/>
        <field name="state">code</field>
        <field name="code">
if records:
    action = {"type": "ir.actions.act_url", "target": "self", "url": "/code_generator/%s" % ','.join(records.mapped(lambda r: str(r.id)))}
        </field>
    </record>

</odoo>